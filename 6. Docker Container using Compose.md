# 🐳 Docker Compose WordPress + MySQL SOP

**Objective:** Deploy WordPress with MySQL using Docker Compose and verify connectivity.

---

## 1️⃣ **Check Docker Compose Version**

```bash
docker compose version
```

**Result:**

```
Docker Compose version v2.40.0
```

| Emoji | Command                  | Meaning                                          |
| ----- | ------------------------ | ------------------------------------------------ |
| 🛠️   | `docker compose version` | Checks which Docker Compose version is installed |

**Info:** You are running **v2.40.0**, which supports modern Compose files.

---

## 2️⃣ **Create Project Directory**

```bash
mkdir -p docker-compose
cd docker-compose/
```

| Emoji | Command                   | Meaning                                             |
| ----- | ------------------------- | --------------------------------------------------- |
| 📁    | `mkdir -p docker-compose` | Creates a directory for your Docker Compose project |
| 📂    | `cd docker-compose/`      | Navigates into the project folder                   |

**Tip:** Organizing your Docker files keeps your setup clean.

---

## 3️⃣ **Check Existing Volumes, Images, Containers**

```bash
docker volume ls
docker images
docker container ls
```

**Results:**

```
docker volume ls
DRIVER    VOLUME NAME
```

```
docker images
REPOSITORY   TAG       IMAGE ID   CREATED   SIZE
```

```
docker container ls
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
```

| Emoji | Command               | Meaning                      |
| ----- | --------------------- | ---------------------------- |
| 📦    | `docker volume ls`    | Lists all Docker volumes     |
| 🖼️   | `docker images`       | Lists all Docker images      |
| 📋    | `docker container ls` | Lists all running containers |

**Note:** At this point, nothing was created yet.

---

## 4️⃣ **Create a Persistent Volume**

```bash
docker volume create db_data
docker volume ls
```

**Result:**

```
db_data
```

| Emoji | Command                        | Meaning                                                       |
| ----- | ------------------------------ | ------------------------------------------------------------- |
| 💾    | `docker volume create db_data` | Creates a Docker volume named `db_data` for MySQL persistence |
| 📦    | `docker volume ls`             | Verify the volume exists                                      |

---

## 5️⃣ **Create `docker-compose.yaml`**

```yaml
version: '3.8'

services:
  db:
    image: mysql:latest
    volumes:
      - db_data:/var/lib/mysql
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: somewordpress
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wordpress
      MYSQL_PASSWORD: wordpress

  wordpress:
    depends_on:
      - db
    image: wordpress:latest
    ports:
      - "8000:80"
    restart: always
    environment:
      WORDPRESS_DB_HOST: db:3306
      WORDPRESS_DB_USER: wordpress
      WORDPRESS_DB_PASSWORD: wordpress
      WORDPRESS_DB_NAME: wordpress
    volumes:
      - db_data:/var/lib/mysql

volumes:
  db_data:
```

**Common Issues Fixed:**

* `volume` → `volumes` ✅
* `enviroment` → `environment` ✅
* Correct indentation and quotes for `ports` ✅

| Emoji | Field        | Meaning                           |
| ----- | ------------ | --------------------------------- |
| 🧩    | `services`   | Defines containers to run         |
| 🗄️   | `volumes`    | Defines persistent storage        |
| 🔌    | `depends_on` | Ensures WordPress waits for MySQL |

---

## 6️⃣ **Validate Compose File**

```bash
docker compose config
```

**Output:** (simplified)

```
wordpress:
  image: wordpress:latest
  ports:
    - 8000:80
db:
  image: mysql:latest
  volumes:
    - db_data:/var/lib/mysql
```

**Info:** Confirms your YAML syntax is correct. ✅

---

## 7️⃣ **Start Containers**

```bash
docker compose up -d
```

**Output:**

```
[+] Running 4/4
✔ Network docker-compose_default Created
✔ Volume docker-compose_db_data Created
✔ Container docker-compose-db-1 Started
✔ Container docker-compose-wordpress-1 Started
```

| Emoji | Command                | Meaning                            |
| ----- | ---------------------- | ---------------------------------- |
| ▶️    | `docker compose up -d` | Starts services in detached mode   |
| 🔄    | `-d`                   | Detached mode (runs in background) |

**Tip:** Watch logs with:

```bash
docker compose logs -f
```

---

## 8️⃣ **Verify Running Containers**

```bash
docker container ls
```

**Output:**

```
CONTAINER ID   IMAGE              COMMAND                  STATUS          PORTS
dda3240a9b6a   wordpress:latest   "docker-entrypoint.s…"   Up 18 minutes   0.0.0.0:8000->80/tcp
6004a9b8feb3   mysql:latest       "docker-entrypoint.s…"   Up 18 minutes   3306/tcp
```

**Info:** WordPress is now accessible at `http://<server-ip>:8000`

---

## 9️⃣ **Network Interfaces**

```bash
ifconfig
```

**Highlights:**

* `docker0` → default bridge network
* `br-xxxx` → created for each Compose project
* Ensures container communication ✅

---

## 🔟 **Test WordPress**

```bash
curl http://<server-ip>:8000/wp-admin/install.php?step=1
```

**Result:** WordPress installation page HTML returned ✅

**Tip:** Open browser → `http://<server-ip>:8000/wp-admin/install.php` to complete setup.

---

## 1️⃣1️⃣ **Stop & Remove Containers**

```bash
docker compose down
```

**Output:**

```
✔ Container docker-compose-wordpress-1  Removed
✔ Container docker-compose-db-1 Removed
✔ Network docker-compose_default Removed
```

| Emoji | Command               | Meaning                                                  |
| ----- | --------------------- | -------------------------------------------------------- |
| 🛑    | `docker compose down` | Stops and removes containers, networks but keeps volumes |
| ❌     | `docker container ps` | Verify no containers are running                         |

---

## 1️⃣2️⃣ **Check Volumes After Removal**

```bash
docker volume ls
```

**Output:**

```
DRIVER    VOLUME NAME
local     db_data
local     docker-compose_db_data
```

**Info:** Data persists in volumes even if containers are removed. ✅

---

## 💡 **Quick Tips / Notes**

| Emoji | Info                                                                                   |
| ----- | -------------------------------------------------------------------------------------- |
| 🔑    | Volume `db_data` keeps MySQL data safe across container recreations                    |
| 🌐    | Use `0.0.0.0:8000->80` to access WordPress from outside the server                     |
| ⚡     | Fix YAML issues by checking: indentation, `environment`, `volumes`, and `ports` format |
| 📝    | Use `docker compose logs -f` to troubleshoot container startup issues                  |
| 💻    | Use `curl` or browser to verify WordPress installation                                 |

---

## ✅ **Interactive Summary**

* **Volume created:** `db_data` 💾
* **Containers running:** WordPress & MySQL 🐳
* **WordPress URL:** `http://<server-ip>:8000/wp-admin/install.php` 🌐
* **Persistent storage:** MySQL database survives container deletion 💾
* **Compose file syntax validated** ✔️
